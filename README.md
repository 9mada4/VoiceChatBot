# 🎤 VoiceChatBot

**音声だけでChatGPTを完全操作！macOS専用の音声制御ボット**

キーボード不要。話すだけでChatGPTとチャットし、自動でボタンクリック・画面操作まで完全自動化。

---

## ✨ 特徴

- **🗣️ 完全音声操作** - キーボード入力一切不要
- **⚡ 超シンプル** - 起動→話す→送信→自動操作の一連の流れを音声で自動化
- **🔒 プライベート** - 全てローカル処理、音声データは外部送信なし
- **�️ 自動画面操作** - 「はい」の音声でスクロール・ボタン検出・クリック
- **🎯 インテリジェント検出** - 複数ボタンがある場合は最下部を自動選択
- **� 全画面対応** - 画面全体からボタンを検索・検出

---

## 🚀 クイックスタート

### 1. セットアップ
```bash
git clone https://github.com/your-username/VoiceChatBot.git
cd VoiceChatBot
chmod +x setup.sh
./setup.sh
```

### 2. 実行
```bash
python voice_chat_bot.py
```

### 3. 基本的な使い方
1. **「お話しください」** と音声読み上げ → 音声入力が自動開始
2. **ChatGPTへの質問を話す** （制限時間なし）
3. **「音声入力終わり」** と話す → 自動で入力停止・送信
4. **「ChatGPTの出力が終了したら『はい』と答えてください」** と読み上げ
5. **「はい」** と話す → 自動で画面スクロール・ボタン検出・クリック

---

## 🎯 音声コマンド一覧

| 場面 | 音声コマンド | 動作 |
|------|------|------|
| **入力終了** | 音声入力終わり / 終わり | 音声入力を停止して自動送信 |
| **画面操作確認** | はい / オッケー / うん | 画面スクロール・ボタン検出・クリック |
| **キャンセル** | いいえ / 終わり / キャンセル | 処理をキャンセル・終了 |

**対応言語：** ひらがな・カタカナ・漢字・英語（大文字・小文字両対応）

---

## �️ 自動画面操作機能

### インテリジェントボタン検出
- **全画面スキャン** - 画面全体からボタン画像を検索
- **PyAutoGUI** による高精度画像認識
- **複数ボタン対応** - 複数検出時は最下部（y座標最大）を自動選択
- **startVoiceBtn.png** 対応 - 音声開始ボタンを自動検出

### 自動操作シーケンス
```
「はい」音声 → 画面スクロール → ボタン検索 → 最下部ボタン選択 → 自動クリック
```

### 技術仕様
- **座標補正なし** - Retina等の高解像度ディスプレイ自動対応
- **全画面対応** - 画面サイズ制限なし
- **エラーハンドリング** - ボタン未検出時の適切な処理

---

## ⚙️ システム要件

### 必須環境
- **macOS** Ventura 13.0以降
- **Python** 3.8以上
- **ChatGPTアプリまたはWebブラウザ** 

### 必須ツール
- **Sox** (音声録音) - Homebrewで自動インストール
- **FFmpeg** (音声処理) - Homebrewで自動インストール
- **PyAutoGUI** (画面操作) - pipで自動インストール

### 必要な権限
- **アクセシビリティ** - キーボード・マウス制御用
- **macOS音声入力** - システム音声入力用
- **画面録画** - PyAutoGUIによる画面操作用

---

## 🔧 技術アーキテクチャ

### デュアル音声システム
| システム | 用途 | 処理方式 |
|---------|------|---------|
| **macOS音声入力** | ChatGPT質問入力 | システム標準（右Cmd×2で起動） |
| **Whisper AI** | 音声コマンド認識 | ローカルAI処理（faster-whisper） |

### 自動化フロー
```
起動 → 音声入力① → 音声監視② → 送信 → 音声確認③ → 画面操作 → 完了
```

### 画面操作技術
- **PyAutoGUI** による画像認識・マウス制御
- **Quartz** によるスクロール・クリック処理
- **インテリジェント検索** - 複数ボタン対応

### セキュリティ設計
- ✅ **完全ローカル処理** - 音声データの外部送信なし
- ✅ **一時ファイル自動削除** - 音声録音ファイルは即座に削除
- ✅ **最小権限** - 必要最小限のシステム権限のみ使用
- ✅ **画像認識のみ** - 画面内容の保存なし（一時的な画像検索のみ）

---

## 📋 セットアップガイド

### 1. 事前準備
1. **ChatGPTアプリまたはWebブラウザ** でChatGPTにアクセス
2. **macOS音声入力** を有効化
   ```
   システム設定 → キーボード → 音声入力 → オン
   ```
3. **アクセシビリティ権限** の準備（実行時に自動で要求されます）
4. **startVoiceBtn.png** を作業ディレクトリに配置（検出対象ボタン画像）

### 2. 自動セットアップ
```bash
# リポジトリクローン
git clone https://github.com/your-username/VoiceChatBot.git
cd VoiceChatBot

# 自動セットアップ実行
chmod +x setup.sh
./setup.sh
```

### 3. 手動セットアップ（必要時）
```bash
# Python依存関係
pip install faster-whisper pyobjc-framework-Quartz pyautogui

# システムツール（Homebrew経由）
brew install sox ffmpeg
```

---

## 🧪 テスト・デバッグ

### 画面操作機能テスト
```bash
python voice_chat_bot.py scroll
```
スクロール・ボタン検出・クリック機能をテストできます。

### 音声機能テスト
```bash
python voice_chat_bot.py test
```
音声認識・確認機能をテストできます。

### デバッグモード
ログレベルを変更してより詳細な情報を確認：
```python
# voice_chat_bot.py内で変更
logging.basicConfig(level=logging.DEBUG)
```

---

## 🛟 トラブルシューティング

### よくある問題と解決方法

| 問題 | 原因 | 解決方法 |
|------|------|---------|
| 音声入力が開始されない | アクセシビリティ権限なし | システム設定でアプリに権限付与 |
| 音声認識が動かない | Sox/FFmpegが未インストール | `brew install sox ffmpeg` |
| 送信されない | ChatGPTアプリが未起動 | ChatGPTアプリまたはブラウザを起動 |
| ボタンが見つからない | startVoiceBtn.pngが未配置 | 対象ボタンの画像を作業ディレクトリに配置 |
| 画面操作が動かない | 画面録画権限なし | システム設定でPythonに画面録画権限付与 |
| ボタンクリックが反応しない | 座標のずれ | PyAutoGUIの座標検出を確認 |

### デバッグ用ファイル
- **startVoiceBtn.png** - 検出対象のボタン画像
- **debug.log** - 実行時のログファイル

### ログ確認
```bash
# 実行時のログを確認
python voice_chat_bot.py 2>&1 | tee debug.log
```

---

## 📄 ライセンス

MIT License - 詳細は [LICENSE](LICENSE) ファイルを参照

---

## 🤝 コントリビューション

プルリクエスト・イシュー報告歓迎！

---

## 📞 サポート

- **GitHub Issues** - バグ報告・機能要望
- **Discussions** - 使い方の質問・アイデア交換
