# 🎤 VoiceChatBot

**音声だけでChatGPTを完全操作！macOS専用の音声制御ボット**

キーボード不要。話すだけでChatGPTとチャットし、結果をスクリーンショット撮影・OCR読み上げまで自動化。

---

## ✨ 特徴

- **🗣️ 完全音声操作** - キーボード入力一切不要
- **⚡ 超シンプル** - 起動→話す→送信→スクリーンショットの一連の流れを音声で自動化
- **🔒 プライベート** - 全てローカル処理、音声データは外部送信なし
- **📸 自動スクリーンショット** - ChatGPTの回答を自動キャプチャ（アクティブウィンドウ）
- **🔍 高精度OCR** - macOS Vision frameworkによる日本語・英語テキスト認識
- **🔊 音声読み上げ** - OCR結果を自動で音声読み上げ

---

## 🚀 クイックスタート

### 1. セットアップ
```bash
git clone https://github.com/your-username/VoiceChatBot.git
cd VoiceChatBot
chmod +x setup.sh
./setup.sh
```

### 2. 実行
```bash
python voice_chat_bot.py
```

### 3. 基本的な使い方
1. **「お話しください」** と音声読み上げ → 音声入力が自動開始
2. **ChatGPTへの質問を話す** （制限時間なし）
3. **「音声入力終わり」** と話す → 自動で入力停止・送信
4. **「ChatGPTの出力が終了したら『はい』と答えてください」** と読み上げ
5. **「はい」** と話す → 自動でスクリーンショット撮影・OCR・読み上げ

---

## 🎯 音声コマンド一覧

| 場面 | 音声コマンド | 動作 |
|------|------|------|
| **入力終了** | 音声入力終わり / 終わり | 音声入力を停止して自動送信 |
| **スクリーンショット確認** | はい / オッケー / うん | ChatGPTウィンドウをキャプチャ・OCR |
| **キャンセル** | いいえ / 終わり / キャンセル | 処理をキャンセル・終了 |

**対応言語：** ひらがな・カタカナ・漢字・英語（大文字・小文字両対応）

---

## 📸 スクリーンショット機能

### 自動ウィンドウキャプチャ
- **アクティブウィンドウ** を自動でキャプチャ
- **screenshots.png** で上書き保存（gitignore済み）
- **影なし・高品質** でキャプチャ

### OCR処理
- **macOS Vision framework** による高精度テキスト認識
- **日本語・英語** の混合テキストに対応
- **自動フォールバック** （Vision未対応時はtextutil使用）

---

## ⚙️ システム要件

### 必須環境
- **macOS** Ventura 13.0以降
- **Python** 3.8以上
- **ChatGPTアプリ** (公式Mac版アプリ)

### 必須ツール
- **Sox** (音声録音) - Homebrewで自動インストール
- **FFmpeg** (音声処理) - Homebrewで自動インストール

### 必要な権限
- **アクセシビリティ** - キーボード制御用
- **macOS音声入力** - システム音声入力用

---

## 🔧 技術アーキテクチャ

### デュアル音声システム
| システム | 用途 | 処理方式 |
|---------|------|---------|
| **macOS音声入力** | ChatGPT質問入力 | システム標準（右Cmd×2で起動） |
| **Whisper AI** | 音声コマンド認識 | ローカルAI処理（faster-whisper） |

### 自動化フロー
```
起動 → 音声入力① → 音声監視② → 送信 → 音声確認③ → スクリーンショット → OCR → 読み上げ
```

### セキュリティ設計
- ✅ **完全ローカル処理** - 音声データの外部送信なし
- ✅ **一時ファイル自動削除** - 音声録音ファイルは即座に削除
- ✅ **最小権限** - アクセシビリティ権限のみ使用
- ✅ **データ非保存** - スクリーンショット以外のデータ保存なし

---

## 📋 セットアップガイド

### 1. 事前準備
1. **ChatGPTアプリ** をMac App Storeからインストール・ログイン
2. **macOS音声入力** を有効化
   ```
   システム設定 → キーボード → 音声入力 → オン
   ```
3. **アクセシビリティ権限** の準備（実行時に自動で要求されます）

### 2. 自動セットアップ
```bash
# リポジトリクローン
git clone https://github.com/your-username/VoiceChatBot.git
cd VoiceChatBot

# 自動セットアップ実行
chmod +x setup.sh
./setup.sh
```

### 3. 手動セットアップ（必要時）
```bash
# Python依存関係
pip install faster-whisper pyobjc-framework-Quartz pyobjc-framework-Vision

# システムツール（Homebrew経由）
brew install sox ffmpeg
```

---

## 🧪 テスト・デバッグ

### スクリーンショット機能テスト
```bash
python voice_chat_bot.py test
```
アクティブウィンドウキャプチャとOCR機能をテストできます。

### デバッグモード
ログレベルを変更してより詳細な情報を確認：
```python
# voice_chat_bot.py内で変更
logging.basicConfig(level=logging.DEBUG)
```

---

## 🛟 トラブルシューティング

### よくある問題と解決方法

| 問題 | 原因 | 解決方法 |
|------|------|---------|
| 音声入力が開始されない | アクセシビリティ権限なし | システム設定でアプリに権限付与 |
| 音声認識が動かない | Sox/FFmpegが未インストール | `brew install sox ffmpeg` |
| 送信されない | ChatGPTアプリが未起動 | ChatGPTアプリを起動してログイン |
| スクリーンショットが撮れない | ウィンドウが見つからない | ChatGPTウィンドウをアクティブに |
| OCRが機能しない | Vision framework未対応 | macOS Venturaに更新 |

### ログ確認
```bash
# 実行時のログを確認
python voice_chat_bot.py 2>&1 | tee debug.log
```

---

## 📄 ライセンス

MIT License - 詳細は [LICENSE](LICENSE) ファイルを参照

---

## 🤝 コントリビューション

プルリクエスト・イシュー報告歓迎！

---

## 📞 サポート

- **GitHub Issues** - バグ報告・機能要望
- **Discussions** - 使い方の質問・アイデア交換
